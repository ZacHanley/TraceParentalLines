#load list of stage 2 codes and their PedigreeItems. This file was created by hand-editing the Stage2 xls and using Word to eliminate all sorts of crap such as cut-and-paste space artifacts
St2codes_to_GroupCodes20150724 <- read.csv("~/R/St2codes_to_GroupCodes20150724.csv")

#variables: alldads is the matrix to be populated, n is a debug variable to allow loop to start at !=1
alldads <- matrix(ncol=2)
colnames(alldads) <- c("maleAncestor","st2Name")
n <- c(1)

#main loop that crawls the file for PedigreeItems and uses EBridaPedigree to create a matrix of each item versus each PedigreeItem in its male line
for (i in n:nrow(St2codes_to_GroupCodes20150724)) {
  st2Name <- as.character(St2codes_to_GroupCodes20150724[i,1])
  st2PedId <- as.character(St2codes_to_GroupCodes20150724[i,2])
  # print(paste(i,st2Name,sep=" ")) #progressforerrorchecking
  ped <- EBridaPedigree(crpId=5,PI=st2PedId) # EBridaPedigree does not fail gracefully so code will choke on empty PI
  ped[is.na(ped)] <- c("NoDad") #prevents a completely empty pedigree killing the loop
  dadcol <- ped$male #make new output column
  newdadlines <- cbind(dadcol,st2Name) #add the Stage2 name
  alldads <- rbind(alldads,newdadlines)
    }

#tidy up
alldads <- alldads[-c(1),]
rm(i,st2PedId,ped,dadline,newdadline)
rm(newdadlines,dadcol,n,st2Name)

#output into Windows due to paranoia
write.csv(alldads, file="alldads.csv")

#remove NoDad entries
malldads <- subset(alldads, maleAncestor!="NoDad")

#load list of dads to check against

#mine all male ancestors against the dad checklist
